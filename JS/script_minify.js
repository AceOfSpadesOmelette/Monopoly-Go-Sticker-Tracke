import{STICKER_DATA as e}from"../Database/StickerData.js";import{SET_DATA as t}from"../Database/SetData.js";import{ALBUM_DATA as n}from"../Database/AlbumData.js";import{NEWS_DATA as r}from"../Database/NewsData.js";import{LANGUAGE_DICTIONARY as a}from"../Database/LanguageDictionary.js";let DefaultCSSSheet=document.getElementById("DefaultCSS"),MobileCSSSheet=document.getElementById("MobileCSS"),MiddleSideBlock=document.getElementById("middle-side"),CurrentStickerBoardBlock=document.querySelector("#sticker-board #current-sticker-board"),BasicMenuNewsBtnComponent=document.getElementById("BasicMenuNewsBtn"),LoadingOverlayBlock=document.getElementById("loading-overlay"),IgnorePrestigeBtnComponent=document.getElementById("IgnorePrestigeBtn"),SortOrderBtnComponent=document.getElementById("SortOrderBtn"),FilterMenuSearchBarComponent=document.getElementById("filtermenu-searchbar"),ClearFiltersBtnComponent=document.getElementById("ClearFiltersBtn"),RefreshFiltersBtnComponent=document.getElementById("RefreshFiltersBtn"),AndOrFilterModeBtnComponent=document.getElementById("AndOrFilterModeBtn"),SpareFilterMinInputComponent=document.getElementById("spare-filter-min"),SpareFilterMaxInputComponent=document.getElementById("spare-filter-max"),SpareFilterBtnComponent=document.getElementById("spare-filter-btn"),PlayerIGNInputComponent=document.getElementById("player-ign"),PlayerLinkInputComponent=document.getElementById("player-link"),LeftoverVaultStarsInputComponent=document.getElementById("leftover-total-vault-quantity"),AlbumIconContainerBlock=document.getElementById("album-logo-container"),SetImageOrientationBtnComponent=document.getElementById("SetImageOrientationBtn"),IncludePlayerIGNBtnComponent=document.getElementById("IncludeIGNBtn"),IncludePlayerLinkBtnComponent=document.getElementById("IncludePlayerLinkBtn"),dlPngButtonComponent=document.getElementById("dl-png"),CollectionScreenshotBlock=document.getElementById("collection-screenshot"),TradeScreenshotBlock=document.getElementById("trade-screenshot"),SnapshotAreaBlock=document.getElementById("snapshot-area"),dlTradePngButtonComponent=document.getElementById("dl-trade-png"),TradeScreenshotContainerBlock=document.getElementById("trade-screenshot-container"),ForTradeScreenshotAreaBlock=document.getElementById("fortrade-screenshot-area"),LookingForScreenshotAreaBlock=document.getElementById("lookingfor-screenshot-area"),ViewportBtnComponent=document.getElementById("ViewportBtn"),LayoutBtnComponent=document.getElementById("LayoutBtn"),CurrentFiltersContentBlock=document.getElementById("current-filters-content"),GenerateTradePostBtnComponent=document.getElementById("generate-trade-post-btn"),ToggleSelectedBtnComponent=document.getElementById("ToggleSelectedBtn"),ResetSparesBtnComponent=document.getElementById("ResetSparesBtn"),ToggleLFBtnComponent=document.getElementById("ToggleLFBtn"),ToggleFTBtnComponent=document.getElementById("ToggleFTBtn"),ResetLFBtnComponent=document.getElementById("ResetLFBtn"),ResetFTBtnComponent=document.getElementById("ResetFTBtn"),ResetAllStickersBtnComponent=document.getElementById("ResetAllStickersBtn"),NewsContentBlock=document.getElementById("news-content"),ChangeStickerStyleBtnComponent=document.getElementById("ChangeStickerStyleBtn"),ProfileListBlock=document.getElementById("profile-list"),SetProgressTrackerBlock=document.getElementById("set-progress-tracker"),ImportBtnComponent=document.getElementById("import-btn"),ImportFromFileBtnComponent=document.getElementById("import-from-file-btn"),ExportBtnComponent=document.getElementById("export-btn"),ExportFromFileBtnComponent=document.getElementById("export-from-file-btn"),ProfileTextAreaComponent=document.getElementById("backup-area"),vaultTierImage=document.querySelector(".vault-tier"),TradePostTextAreaComponent=document.querySelector(".trade-post-area"),CopyTradePostAreaBtnComponent=document.getElementById("copy-trade-post-area"),ManageProfileImg=document.querySelector(".ManageProfileImg"),ChangeAlbumMenuBlock=document.getElementById("change-album-menu"),FilterSortModal=document.getElementById("filter-sort-modal"),FilterSortMenuMobileOpenBtn=document.getElementById("mobileMenuFilters"),FilterSortMenuMobileCloseBtn=document.getElementById("filter-sort-menu-footer"),ProgressMenuModal=document.getElementById("progress-menu-modal"),ProgressMenuMobileOpenBtn=document.getElementById("mobileMenuOptions"),ProgressMenuMobileCloseBtn=document.getElementById("progress-menu-footer"),CurrentFiltersModal=document.getElementById("current-filters-modal"),CurrentFiltersOpenBtn=document.getElementById("ViewCurrentFiltersBtn"),CurrentFiltersCloseBtn=document.getElementById("current-filters-footer"),ManageProfileModal=document.getElementById("manage-profile-modal"),ManageProfileOpenBtn=document.getElementById("ManageProfileBtn"),ManageProfileCloseBtn=document.getElementById("manage-profile-footer"),BasicMenuModal=document.getElementById("basic-menu-modal"),BasicMenuMobileOpenBtn=document.getElementById("mobileBasicMenu"),BasicMenuWebOpenBtn=document.getElementById("webBasicMenu"),BasicMenuMobileCloseBtn=document.getElementById("basic-menu-footer"),ButtonGroupTitleElementGroup=document.querySelectorAll(".btn-grp-title"),AccordionElementGroup=document.querySelectorAll(".accordion"),BasicMenuNavBtnElementGroup=document.querySelectorAll(".basic-menu-nav-btn"),BasicMenuSubcontainerElementGroup=document.querySelectorAll(".basic-menu-subcontainer"),SortBtnElementGroup=document.querySelectorAll(".sort-btn"),FilterBtnElementGroup=document.querySelectorAll(".filter-btn"),TradeButtonContainerBtnGroup=document.querySelectorAll(".trade-button-container .btn"),StaticButtonsGroup=document.querySelectorAll(".btn"),LanguageButtons=document.querySelectorAll(".translation-btn"),TranslationElements=document.querySelectorAll("[data-translation-key]"),TierOneVaultQuantitySpan=document.getElementById("TierOneVaultQuantity"),TierTwoVaultQuantitySpan=document.getElementById("TierTwoVaultQuantity"),TierThreeVaultQuantitySpan=document.getElementById("TierThreeVaultQuantity"),SortOrderBtnTextSpan=document.getElementById("SortOrderBtnText"),FilterLengthTextSpan=document.getElementById("filterLength"),AndOrFilterModeBtnTextSpan=document.getElementById("AndOrFilterModeBtnText"),AndOrFilterModeBtnTooltipTextSpan=document.getElementById("AndOrFilterModeBtnTooltip"),TotalGoldQuantityTextSpan=document.getElementById("total-gold-quantity"),GoldQuantityTextSpan=document.getElementById("gold-quantity"),GoldPercentageTextSpan=document.getElementById("gold-percentage"),NextVaultCounterTextSpan=document.getElementById("NextVaultCounter"),ViewportBtnTextSpan=document.getElementById("ViewportBtnText"),LayoutBtnTextSpan=document.getElementById("LayoutBtnText"),ChangeStickerStyleBtnTextSpan=document.getElementById("ChangeStickerStyleBtnText"),TotalStickersQuantityTextSpan=document.getElementById("total-stickers-quantity"),UserStickersQuantityTextSpan=document.getElementById("user-stickers-quantity"),TotalVaultQuantityTextSpan=document.getElementById("total-vault-quantity"),StartTimeTextSpan=document.getElementById("start-time"),EndTimeTextSpan=document.getElementById("end-time"),TimeLeftTextSpan=document.getElementById("time-left"),CopyTradePostAreaBtnTextSpan=document.getElementById("copy-trade-post-area-btn-text"),CurrentAlbumNumber=getCurrentAlbumNumber(),VaultTierOne=250,VaultTierTwo=500,VaultTierThree=700,userData={},UserProfileList=JSON.parse(localStorage.getItem("UserProfileList"))||[],FilterList={},AndZeroOrOne=0,AscendZeroDescendOne=0,IgnorePrestige=0,WebZeroMobileOne=0,LightZeroDarkOne=0,ImgOrientationLandscapeZeroPortraitOne=0,StickerSelectedZeroShowOneBack=0,CurrentLanguageCode="EN",defaultValues={id:"0",selected:0,spare:0,show:1,havespare:0,lookingfor:0,fortrade:0};function init(t){InsertVaultTierQuantity(),GenerateFilterSetButtons(),GenerateChangeAlbumButtons(),SetDefaultFilterStates(),document.querySelector(`button[data-translation-pointer= ${CurrentLanguageCode}]`).click();let n=localStorage.getItem("userData");n?(importUserData(n),ProfileTextAreaComponent.value=n):CreateNewUserData(e),generateCurrentStickerBoard(e,userData,"current-sticker-board"),PerformSort({currentTarget:document.querySelector("button[data-sort-type='GlobalID']")}),NotSelectedByDefault(),UpdateTotalStickerQuantity(),UpdateTotalStickerByRarityQuantity(),countSelectedStickers(),countVaultStickers(),handleBasicMenuNavigationClick({target:BasicMenuNewsBtnComponent});let r=document.querySelectorAll(".change-album-btn");r.forEach(e=>{let t=e.getAttribute("data-album-number");t===CurrentAlbumNumber&&e.classList.add("btnBlue")}),UpdateAlbumStartEndTime(),t()}function getCurrentAlbumNumber(){let e=Math.floor(Date.now()/1e3),t=0,r="";for(let a=0;a<n.length;a++){let l=n[a],o=parseInt(l.StartTime);o<=e&&(o>t||0===t)&&(t=o,r=l.AlbumNo)}if(""===r){let s=0;for(let c=0;c<n.length;c++){let u=n[c],d=parseInt(u.AlbumNo);d>s&&(s=d)}r=s.toString()}return r}function InsertVaultTierQuantity(){TierOneVaultQuantitySpan.textContent=250,TierTwoVaultQuantitySpan.textContent=500,TierThreeVaultQuantitySpan.textContent=700}function SetDefaultFilterStates(){let e=document.querySelectorAll("[data-filtervalue]");e.forEach(e=>{let t=e.getAttribute("data-filtervalue"),n=t.split(">")[1],r=t.split(">")[2];r.includes("|")&&(r=r.split("|")),FilterList[t]={inDatabase:t.split(">")[0],FilterName:t,FilterKey:n,FilterValue:r,FilterState:0}})}function CreateNewUserData(e){userData={},e.filter(e=>e.AlbumNo===CurrentAlbumNumber).forEach(e=>{let t={...defaultValues,id:e.GlobalID};userData[e.GlobalID]=t})}function NotSelectedByDefault(){let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{e.classList.contains("selected")||e.classList.add("not-selected"),ApplySelectedStyle(e)})}function generateCurrentStickerBoard(t,n,r){let a=document.getElementById(r),l=document.createDocumentFragment();for(let o of t.filter(e=>e.GlobalID in n)){let s=n[o.GlobalID],c=s.id,u=document.querySelector(`.sticker-card-container[data-global][data-global="${c}"]`),d=e.find(e=>e.GlobalID===c);if(1===IgnorePrestige&&"1"===d.Prestige){u&&u.remove();continue}if(1===s.show){if(!u){let p=CreateStickerElement(o,"sticker-card-container","sticker-card",!0);l.appendChild(p)}}else 0===s.show&&u&&u.remove()}a.appendChild(l)}function getStickerClasses(e,t){let n="sticker-name";return e.length>14&&(n="sticker-name-long-min14"),e.length>18&&(n="sticker-name-long-min18"),isBrighterThan(t,"#CCCCCC")&&(n+="-dark"),n}function getFrameHTML(e){return"1"===e?'<img draggable="false" class="gold-frame" src="assets/stickers/BG_StickerSpecial.png">':'<img draggable="false" class="normal-frame" src="assets/stickers/BG_StickerBasic.png">'}function getRibbonStyle(e,t,n){return`background: ${t}; 
          background: -moz-linear-gradient(90deg, ${t} 0%, ${e} 10%, ${e} 90%, ${t} 100%); 
          background: -webkit-linear-gradient(90deg, ${t} 0%, ${e} 10%, ${e} 90%, ${t} 100%); 
          background: linear-gradient(90deg, ${t} 0%, ${e} 10%, ${e} 90%, ${t} 100%); 
          border: 2px solid ${n};`}function createStickerStructureContainerInnerHTML(e,t,n,r,a,l,o,s,c,u,d,p){return`
      <div class="sticker-star-container">
        <img draggable="false" class="star-img" src="assets/stickers/Collections_Star_${p}Star.png">
      </div>
      <div class="sticker-photo-container">
        <img draggable="false" class="${c}" src="stickers/${u}/${d}">
        ${n}
      </div>
      <div class="sticker-ribbon" style="${r}">
        <span class="${t}">
          <span>
            <span data-translation-key="set">${a}</span>&nbsp;${l}&ensp;#${o}
          </span>
          <span class="StickerNameText" data-stickerid="${s}"></span>
        </span>
      </div>`}function CreateStickerElement(e,t,n,r){let{SetID:l,AlbumNo:o,GlobalID:s,AlbumName:c,Golden:u,StickerRarity:d,ImageSource:p,Colour:g}=e,m=e[`StickerName${CurrentLanguageCode}`],f=DarkenColour(g,15),S=DarkenColour(g,5),y=getStickerClasses(m,g),b=getFrameHTML(u),C=getRibbonStyle(g,S,f),B=a.find(e=>"set"===e["translation-key"])[CurrentLanguageCode],L=document.createElement("div");L.dataset.global=s,L.classList.add(t);let h=document.createElement("div");return h.classList.add("sticker-structure-container"),L.appendChild(h),h.innerHTML=createStickerStructureContainerInnerHTML(e,y,b,C,B,l-100*o,s-100*l,s,n,c,p,d),r&&(appendSpareSpinner(L),appendTradeButtons(L),RestoreSelected(userData,L),RestoreStickerSpares(userData,L),RestoreTradeStates(userData,L)),L}function ApplySelectedStyle(t){let n=e.find(e=>e.GlobalID===t.getAttribute("data-global")),{SetID:r,AlbumNo:l,GlobalID:o,AlbumName:s,Golden:c,StickerRarity:u,ImageSource:d,Colour:p}=n,g=n[`StickerName${CurrentLanguageCode}`],m=userData[n.GlobalID],f=t.querySelector(".sticker-structure-container"),S=r-100*l,y=o-100*r,b=DarkenColour(p,15),C=DarkenColour(p,5),B=getStickerClasses(g,p),L=getFrameHTML(c),h=getRibbonStyle(p,C,b),$=a.find(e=>"set"===e["translation-key"])[CurrentLanguageCode];f.innerHTML=createStickerStructureContainerInnerHTML(n,B,L,h,$,S,y,o,"sticker-card",s,d,u),0===m.selected&&1===StickerSelectedZeroShowOneBack&&(f.innerHTML=`
      <div class="sticker-star-container">
        <img draggable="false" class="star-img" src="assets/stickers/Collections_Star_${u}Star_Grey.png">
      </div>
      <div class="sticker-photo-container">
        <img draggable="false" class="sticker-card" src="${"1"===c?"assets/stickers/CardBack_Special.png":"assets/stickers/CardBack_Basic_0.png"}">
      </div>
      <div class="sticker-ribbon-transparent">
        <span class="${B}" style="color: #9a9381;">
          <span>
            <span data-translation-key="set">${$}</span>&nbsp;${S}&ensp;#${y}
          </span>
          <span class="StickerNameText" data-stickerid="${o}"></span>
        </span>
      </div>`),t.style.opacity=0===m.selected&&0===StickerSelectedZeroShowOneBack?"0.4":"1.0",t.style.transition="0.1s",TranslateStickerName(t,CurrentLanguageCode);let v=t.querySelector(".spare-spinner-container");0===StickerSelectedZeroShowOneBack?v.style.marginTop="2px":1===StickerSelectedZeroShowOneBack&&(0===WebZeroMobileOne?v.style.marginTop=(m.selected,"2px"):1===WebZeroMobileOne&&(t.querySelector(".sticker-ribbon-transparent"),m.selected,v.style.marginTop="2px"))}function appendSpareSpinner(e){let t=document.createElement("div");t.classList.add("spare-spinner-container");let n=a.find(e=>"SpareLabel"===e["translation-key"])[CurrentLanguageCode];t.innerHTML=`
    <div class="spare-field">
      <label for="SpareQuantity" class="spare-header" data-translation-key="SpareLabel">${n}</label>
      <input type="number" inputmode="numeric" id="SpareQuantity" class="spare-text" name="SpareQuantity" min="0" max="100" value="0"size="3">
    </div>
  `,e.appendChild(t)}function appendTradeButtons(e){let t=document.createElement("div");t.classList.add("trade-button-container"),t.classList.add("BtnGroup2"),t.innerHTML=`
    <button class="lfft-btn lf-btn" type="button" data-property="lookingfor" tabindex="-1">LF</button><button class="lfft-btn ft-btn" type="button" data-property="fortrade" tabindex="-1">FT</button>
  `,e.appendChild(t);let n=t.querySelectorAll(".lfft-btn");n.forEach(e=>{e.addEventListener("mousedown",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("mouseup",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("mouseleave",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("touchstart",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("touchend",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("click",e=>{let t=e.target.closest(".lfft-btn"),n=t.closest(".sticker-card-container").getAttribute("data-global"),r=t.getAttribute("data-property");t&&updateLFOrFTValue(n,r)})})}function updateLFOrFTValue(e,t){let n=document.querySelector(`[data-global="${e}"] .trade-button-container .lfft-btn[data-property="${t}"]`);n&&(userData[e][t]=(userData[e][t]+1)%2,1===userData[e][t]?("lookingfor"===t&&n.classList.add("btnRed"),"fortrade"===t&&n.classList.add("btnGreen")):("lookingfor"===t&&n.classList.remove("btnRed"),"fortrade"===t&&n.classList.remove("btnGreen")))}function PerformSort(e){let t=e.currentTarget,n=t.dataset.sortType,r=Array.from(document.querySelectorAll("#current-sticker-board .sticker-card-container"));if(0!==r.length){if(r.sort((e,t)=>{let r=findStickerData(e.dataset.global),a=findStickerData(t.dataset.global);"StickerName"===n&&(n=`StickerName${CurrentLanguageCode}`);let l=r[n],o=a[n];if(!isNaN(l)&&!isNaN(o)){let s=parseFloat(l),c=parseFloat(o);return s===c?compareStickerNames(r,a):s-c}return l===o?compareStickerNames(r,a):l.localeCompare(o)}),"selected"===t.dataset.sortOnsite){let{selectedContainers:a,notSelectedContainers:l}=PerformSortOnsite(t),o=r[0].parentElement;a.forEach(e=>o.appendChild(e)),l.forEach(e=>o.appendChild(e))}else if("spare"===t.dataset.sortOnsite){let{sortSpareContainers:s}=PerformSortOnsite(t),c=r[0].parentElement;s.forEach(e=>c.appendChild(e))}else{let u=r[0].parentElement;r.forEach(e=>u.appendChild(e))}1===AscendZeroDescendOne&&Array.from(CurrentStickerBoardBlock.children).reverse().forEach(e=>{CurrentStickerBoardBlock.appendChild(e)}),SortBtnElementGroup.forEach(e=>e.classList.remove("btnBlue")),t.classList.add("btnBlue")}}function PerformSortOnsite(e){let t=document.querySelectorAll("#current-sticker-board .sticker-card-container"),n=e.dataset.sortOnsite;if("selected"===n){let r=Array.from(t).filter(e=>{let t=e.getAttribute("data-global");return 1===userData[t].selected}),a=Array.from(t).filter(e=>{let t=e.getAttribute("data-global");return 0===userData[t].selected});return{selectedContainers:r,notSelectedContainers:a}}if("spare"===n){let l=Array.from(t).sort((e,t)=>{let n=e.getAttribute("data-global"),r=t.getAttribute("data-global"),a=userData[n].spare,l=userData[r].spare;return a-l});return{sortSpareContainers:l,selectedContainers:[],notSelectedContainers:[]}}return{sortSpareContainers:[],selectedContainers:[],notSelectedContainers:[]}}function findStickerData(t){return e.find(e=>e.GlobalID===t)}function compareStickerNames(e,t){let n=e.GlobalID,r=t.GlobalID;return n.localeCompare(r)}function handleSortOrderBtnClick(){AscendZeroDescendOne=(AscendZeroDescendOne+1)%2,Array.from(CurrentStickerBoardBlock.children).reverse().forEach(e=>{CurrentStickerBoardBlock.appendChild(e)}),SortOrderBtnTextSpan.setAttribute("data-translation-key",`SortOrderBtnText_${AscendZeroDescendOne}`),translateLanguage(CurrentLanguageCode,`SortOrderBtnText_${AscendZeroDescendOne}`)}function FilterBySearchbar(n){let r=FilterMenuSearchBarComponent.getAttribute("data-filtervalue");if(""===FilterMenuSearchBarComponent.value){FilterList[r].FilterState=0,userData[n].show=1,updateClearFiltersButton();return}let a=FilterMenuSearchBarComponent.value.trim();a=(a=a.includes(",")?a.split(",").map(function(e){return e.trim()}):[a]).filter(function(e){return""!==e.trim()}),FilterList.hasOwnProperty(r)&&(FilterList[r].FilterValue=a,FilterList[r].FilterState=a.length>0?1:0);let l=e.find(function(e){return e.GlobalID===n}),o=l.SetID,s=t.find(function(e){return e.SetID===o}),c=s[`SetName${CurrentLanguageCode}`];if(l){let u=l[`StickerName${CurrentLanguageCode}`].toLowerCase().replace(/é/g,"e").replace(/ü/g,"u").replace(/'/g,"").replace(/！/g,"!"),d=c.toLowerCase().replace(/é/g,"e").replace(/ü/g,"u").replace(/'/g,"").replace(/！/g,"!"),p=a.map(function(e){return e.toLowerCase().replace(/é/g,"e").replace(/ü/g,"u").replace(/'/g,"").replace(/！/g,"!")});if(1===a.length)u.includes(p[0])||d.includes(p[0])||n.toString()===p[0]||l.SetID.toString()===p[0]?userData[n].show=1:userData[n].show=0;else if(a.length>1){if(0===AndZeroOrOne)p.every(function(e){return u.includes(e)||d.includes(e)||n.toString()===e||l.SetID.toString()===e})?userData[n].show=1:userData[n].show=0;else if(1===AndZeroOrOne){if(p.some(function(e){return u.includes(e)||d.includes(e)||n.toString()===e||l.SetID.toString()===e})){userData[n].show=1;return}userData[n].show=0}}}}function ChangeFilterButtonState(e,t){t&&(FilterList[e.dataset.filtervalue]={...FilterList[e.dataset.filtervalue],FilterState:(FilterList[e.dataset.filtervalue].FilterState+1)%3}),ChangeFilterBtnStyle(e)}function ChangeFilterBtnStyle(e){let t=FilterList[e.dataset.filtervalue].FilterState;0===t?e.classList.remove("btnRed","btnGreen"):1===t?(e.classList.add("btnGreen"),e.classList.remove("btnRed")):2===t&&(e.classList.add("btnRed"),e.classList.remove("btnGreen"))}function updateClearFiltersButton(){let e=0;Object.values(FilterList).forEach(t=>{0!==t.FilterState&&e++}),FilterLengthTextSpan.textContent=`(${e})`,ChangeClearFiltersButtonStyle()}function ChangeClearFiltersButtonStyle(){let e=parseInt(FilterLengthTextSpan.textContent.replace(/\D/g,""));e>0?ClearFiltersBtnComponent.classList.add("btnRed"):ClearFiltersBtnComponent.classList.remove("btnRed")}function clearFilters(){FilterMenuSearchBarComponent.value="",Object.values(FilterList).forEach(e=>{if(0!==e.FilterState&&"1>StickerName>"!==e.FilterName){e.FilterState=0;let t=document.querySelector(`.filter-btn[data-filtervalue="${e.FilterName}"]`);ChangeFilterButtonState(t,!1)}}),PerformFilters(userData)}function PerformFilters(t){for(let n in t)t[n].show=1,0===AndZeroOrOne?(FilterBySpareRange(FilterList,n),1===t[n].show&&(FilterBySearchbar(n),1===t[n].show&&FilterByButtons(n))):1===AndZeroOrOne&&(FilterBySpareRange(FilterList,n),1===t[n].show&&(FilterByButtons(n),0===IncludeStateFilters.length&&0===ExcludeStateFilters.length&&(t[n].show=0,""===FilterMenuSearchBarComponent.value&&(t[n].show=1)),0===t[n].show&&""!==FilterMenuSearchBarComponent.value&&FilterBySearchbar(n)));""===FilterMenuSearchBarComponent.value&&(FilterList[FilterMenuSearchBarComponent.getAttribute("data-filtervalue")].FilterState=0),updateClearFiltersButton(),CurrentStickerBoardBlock.querySelector(".current-sticker-board-none")&&CurrentStickerBoardBlock.querySelector(".current-sticker-board-none").remove(),CurrentStickerBoardBlock.style.alignContent="",generateCurrentStickerBoard(e,t,"current-sticker-board");let r=Array.from(document.querySelectorAll("#current-sticker-board .sticker-card-container"));if(0===r.length){let l=a.find(e=>"NoMatchesFound"===e["translation-key"])[CurrentLanguageCode];CurrentStickerBoardBlock.innerHTML=`<span class="current-sticker-board-none" data-translation-key="NoMatchesFound">${l}</span>`,CurrentStickerBoardBlock.style.alignContent="center";return}{let o=document.querySelector(".sort-btn.btnBlue");o?PerformSort({currentTarget:o}):PerformSort({currentTarget:document.querySelector('button[data-sort-type="GlobalID"]')})}}window.onload=function(){compareViewport(),LoadingOverlayBlock.style.display="block",setTimeout(()=>{init(function(){LoadingOverlayBlock.style.display="none",LoadNews()})},0)},IgnorePrestigeBtnComponent.addEventListener("click",function(){1==(IgnorePrestige=(IgnorePrestige+1)%2)?IgnorePrestigeBtnComponent.classList.add("btnGreen"):IgnorePrestigeBtnComponent.classList.remove("btnGreen"),GenerateFilterSetButtons(),document.querySelector("#stickerset-filter .btn-subgroup").querySelectorAll(".filter-btn").forEach(e=>{ChangeFilterBtnStyle(e)}),UpdateTotalStickerQuantity(),UpdateTotalStickerByRarityQuantity();let t=document.querySelectorAll(".sticker-card-container");t.forEach(t=>{let n=e.find(e=>e.GlobalID===t.getAttribute("data-global"));"1"===n.Prestige&&(RestoreSelected(userData,t),RestoreStickerSpares(userData,t),RestoreTradeStates(userData,t),ChangeUserDataHaveSpareValue(userData,t))}),PerformFilters(userData),countSelectedStickers(),countVaultStickers()}),TradeButtonContainerBtnGroup.forEach(function(e){e.addEventListener("click",function(){let t=e.closest(".sticker-card-container").getAttribute("data-global"),n=e.getAttribute("data-property");updateLFOrFTValue(t,n)})}),StaticButtonsGroup.forEach(e=>{e.addEventListener("mousedown",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("mouseup",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("mouseleave",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("touchstart",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("touchend",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")})}),SortBtnElementGroup.forEach(e=>{e.addEventListener("click",e=>{PerformSort(e)})}),SortBtnElementGroup.forEach(e=>e.addEventListener("click",PerformSort)),SortOrderBtnComponent.addEventListener("click",handleSortOrderBtnClick),FilterMenuSearchBarComponent.addEventListener("input",()=>{PerformFilters(userData)}),document.addEventListener("click",function(e){"ClearFilterMenuSearchBar"===e.target.id&&(FilterMenuSearchBarComponent.value="",PerformFilters(userData))}),FilterBtnElementGroup.forEach(e=>{e.addEventListener("click",()=>{ChangeFilterButtonState(e,!0),PerformFilters(userData)})}),ClearFiltersBtnComponent.addEventListener("click",()=>{clearFilters()}),RefreshFiltersBtnComponent.addEventListener("click",function(){PerformFilters(userData)}),AndOrFilterModeBtnComponent.addEventListener("click",function(){AndZeroOrOne=(AndZeroOrOne+1)%2,AndOrFilterModeBtnTextSpan.setAttribute("data-translation-key",`AndOrFilterModeBtnText_${AndZeroOrOne}`),translateLanguage(CurrentLanguageCode,`AndOrFilterModeBtnText_${AndZeroOrOne}`),AndOrFilterModeBtnTooltipTextSpan.setAttribute("data-translation-key",`AndOrFilterModeBtnTooltipText_${AndZeroOrOne}`),translateLanguage(CurrentLanguageCode,`AndOrFilterModeBtnTooltipText_${AndZeroOrOne}`),PerformFilters(userData)});let DefaultStateFilters=[],IncludeStateFilters=[],ExcludeStateFilters=[];function FilterByButtons(n){let r=e.find(function(e){return e.GlobalID===n});for(let a in DefaultStateFilters.length=0,IncludeStateFilters.length=0,ExcludeStateFilters.length=0,FilterList){let l=FilterList[a];if("1>StickerName>"!==l.FilterName&&"0>spare>spare-filter-min|spare-filter-max"!==l.FilterName){if(l.FilterName.includes("SetID")){let o=l.FilterName.split(">")[2],s=t.find(e=>e.SetID===o);if(s&&1===IgnorePrestige&&"1"===s.Prestige)continue}switch(l.FilterState){case 0:DefaultStateFilters.push(l);break;case 1:IncludeStateFilters.push(l);break;case 2:ExcludeStateFilters.push(l)}}}if(0===IncludeStateFilters.length&&0===ExcludeStateFilters.length){userData[n].show=1;return}if(0===AndZeroOrOne){for(let c of IncludeStateFilters){let u=c.FilterKey;"0"===c.inDatabase?userData[n][u]!==parseInt(c.FilterValue)&&(userData[n].show=0):"1"===c.inDatabase&&r[u]!==c.FilterValue&&(userData[n].show=0)}for(let d of ExcludeStateFilters){let p=d.FilterKey;"0"===d.inDatabase?userData[n][p]===parseInt(d.FilterValue)&&(userData[n].show=0):"1"===d.inDatabase&&r[p]===d.FilterValue&&(userData[n].show=0)}}else if(1===AndZeroOrOne){if(IncludeStateFilters.length>0)for(let g of IncludeStateFilters){let m=g.FilterKey;if("0"===g.inDatabase){if(userData[n][m]===parseInt(g.FilterValue)){userData[n].show=1;return}userData[n].show=0}else if("1"===g.inDatabase){if(r[m]===g.FilterValue){userData[n].show=1;return}userData[n].show=0}}if(0===userData[n].show||ExcludeStateFilters.length>0)for(let f of ExcludeStateFilters){let S=f.FilterKey;if("0"===f.inDatabase){if(userData[n][S]!==parseInt(f.FilterValue)){userData[n].show=1;return}userData[n].show=0;return}if("1"===f.inDatabase){if(r[S]!==f.FilterValue){userData[n].show=1;return}userData[n].show=0;return}}}}function handleExpandBtnIconClick(){Array.from(ButtonGroupTitleElementGroup).forEach(e=>{e.addEventListener("click",e=>{let t=e.currentTarget.querySelector(".ExpandBtnIcon"),n=t.getAttribute("src"),r="UpwardsArrow.png",a="DownwardsArrow.png",l=n.substring(n.lastIndexOf("/")+1);l===r?t.src=n.replace(r,a):l===a&&(t.src=n.replace(a,r))})})}document.addEventListener("DOMContentLoaded",()=>{handleExpandBtnIconClick()}),document.addEventListener("click",e=>{let t=e.target,n=t.closest(".sticker-card-container");n&&t.classList.contains("sticker-card")&&(n.classList.toggle("selected"),n.classList.toggle("not-selected"),UpdateCurrentAlbumStickerStates(n.getAttribute("data-global")),ApplySelectedStyle(n),ChangeUserDataHaveSpareValue(userData,n),countSelectedStickers(),countVaultStickers())}),ButtonGroupTitleElementGroup.forEach(e=>{e.addEventListener("click",()=>{let t=e.parentElement,n=t.querySelectorAll(".btn-subgroup");n.forEach(e=>{e.classList.toggle("hidden")})})});let stickerContainer=CurrentStickerBoardBlock;function handleFilterInput(e){let t=e.target;t.classList.contains("spare-filter-text")&&(t.value=t.value.replace(/^0+(?=\d)/,""),t.value>100?"100"===t.value.slice(0,-1)?t.value="100":t.value=t.value.slice(0,2):t.value<0?t.value=0:""===t.value&&setTimeout(()=>{""===t.value&&(t.value=0)},5e3))}function SwapSpareFilterMinMax(e){if(parseInt(SpareFilterMinInputComponent.value)>parseInt(SpareFilterMaxInputComponent.value)){let t=SpareFilterMaxInputComponent.value,n=SpareFilterMinInputComponent.value;SpareFilterMinInputComponent.value=t,SpareFilterMaxInputComponent.value=n}}function UpdateCurrentAlbumStickerStates(e){let t=document.querySelector(`.sticker-card-container[data-global="${e}"]`),n=t.classList.contains("not-selected")?0:1,r=parseInt(t.querySelector(".spare-text").value);userData[e]={...userData[e],selected:n,spare:r}}function FilterBySpareRange(e,t){let n=e["0>spare>spare-filter-min|spare-filter-max"];if(n&&0===n.FilterState){userData[t].show=1;return}let[r,a]=n.FilterValue,l=parseInt(document.getElementById(r).value,10),o=parseInt(document.getElementById(a).value,10),s=2===n.FilterState,c=parseInt(userData[t].spare,10);c>=l&&c<=o?userData[t].show=s?0:1:userData[t].show=s?1:0}function RestoreStickerSpares(e,t){let n=t.getAttribute("data-global"),r=e[n],a=r.spare;t.querySelector(".spare-text").value=a}function RestoreSelected(e,t){let n=t.getAttribute("data-global");t.classList.toggle("selected",1===e[n].selected),t.classList.toggle("not-selected",0===e[n].selected),ApplySelectedStyle(t)}function RestoreTradeStates(e,t){let n=t.getAttribute("data-global"),r=e[n];t.querySelector('.trade-button-container .lfft-btn[data-property="lookingfor"]').classList.remove("btnRed"),t.querySelector('.trade-button-container .lfft-btn[data-property="fortrade"]').classList.remove("btnGreen"),1===r.lookingfor&&t.querySelector('.trade-button-container .lfft-btn[data-property="lookingfor"]').classList.add("btnRed"),1===r.fortrade&&t.querySelector('.trade-button-container .lfft-btn[data-property="fortrade"]').classList.add("btnGreen")}function updateProgressBar(){let e=document.querySelectorAll(".progress-container");e.forEach(function(e){let t=e.querySelector(".progress-text").textContent;t=t.replace(/\s/g,"");let n=parseInt(t.split("/")[0]),r=parseInt(t.split("/")[1]),a=e.querySelector(".progress-bar");if(0===n)a.style.width="0";else{let l=n/r*100;a.style.width="100%",n<r?a.style.background=`linear-gradient(90deg, #34c7fb ${l}%, var(--progress-bar-black) ${l}%)`:(a.style.background="",a.style.backgroundColor="#37ad3f")}})}function GenerateFilterSetButtons(){let n=document.querySelector("#stickerset-filter .btn-subgroup");n.innerHTML=SetProgressTrackerBlock.innerHTML="",t.filter(e=>e.AlbumNo===CurrentAlbumNumber).forEach(t=>{let{SetID:r,Colour:l,AlbumNo:o}=t,s=parseInt(r)-100*parseInt(o),c=t[`SetName${CurrentLanguageCode}`],u=`Icon_${r}.png`,d=e.filter(e=>e.SetID===r).length,p=t.Prestige,g=n.querySelector(`[data-filtervalue="1>SetID>${r}"]`),m=SetProgressTrackerBlock.querySelector(`[data-setidnumber="${r}"]`),f=a.find(e=>"set"===e["translation-key"])[CurrentLanguageCode];if(1===IgnorePrestige&&"1"===p)g&&g.remove(),m&&m.remove();else{if(!g){let S=`
          <button data-filtervalue="1>SetID>${r}" class="filter-btn btn" type="button"><span data-translation-key="set">${f}</span>&nbsp;${s}</button>
        `;n.innerHTML+=S}if(!m){let y="set-name";c.length>15&&(y="set-name-long-min15"),isBrighterThan(l,"#CCCCCC")&&(y+="-dark");let b=`
            <div class="set-card-container"><img draggable="false" data-setidnumber="${r}" class="set-logo" src="logo/${u}"><div class="${y}" style="background-color: ${l};"><span><span data-translation-key="set">${f}</span> ${s}</span><span class="SetNameText" data-setid="${r}"></span></div><div class="progress-container"><div class="progress-bar"></div><div class="progress-text"><span data-setid="${r}">0</span> / ${d}</div></div></div>
          `;SetProgressTrackerBlock.innerHTML+=b}}}),translateLanguage(CurrentLanguageCode,"set"),TranslateSetName(CurrentLanguageCode);let r=n.querySelectorAll(".filter-btn");r.forEach(e=>{e.addEventListener("mousedown",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("mouseup",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("mouseleave",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("touchstart",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("touchend",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("click",e=>{let t=e.target.closest(".filter-btn");t&&(ChangeFilterButtonState(t,!0),PerformFilters(userData))})})}function exportUserData(e){Object.keys(userData).forEach(e=>{userData[e].spare=parseInt(userData[e].spare),userData[e]={...defaultValues,...userData[e]}});let t=PlayerIGNInputComponent.value,n=PlayerLinkInputComponent.value,r=LeftoverVaultStarsInputComponent.value,a=(IgnorePrestige+1)%2,l=[`CurrentAlbumNumber: ${CurrentAlbumNumber}`,`IsPrestige: ${a}`,`player-ign: ${t}`,`player-link: ${n}`,`leftover-vault-stars: ${r}`,],o=JSON.stringify(userData,null,2),s=l.join("\n")+"\n"+o;ProfileTextAreaComponent.value=s,e&&(localStorage.setItem("userData",s),SaveToProfileList())}function importUserData(t){if(""===t){console.error("Textarea value is empty.");return}let r;try{let a="",l="",o="",s="",c=1,u=t.split("\n");u.forEach((t,r)=>{if(t.startsWith("CurrentAlbumNumber: ")){if((s=t.substring(20))!==CurrentAlbumNumber){if(n.find(e=>e.AlbumNo===s))document.querySelector(`button[data-album-number = "${s}"]`).click();else throw console.error("Incorrect Album:",s,", new userData for the current album will be created."),CreateNewUserData(e),Error("Incorrect Album")}}else t.startsWith("IsPrestige: ")?c=parseInt(t.substring(12)):t.startsWith("player-ign: ")?a=t.substring(12):t.startsWith("player-link: ")?l=t.substring(13):t.startsWith("leftover-valve-stars: ")?u[r]=t.replace("leftover-valve-stars: ","leftover-vault-stars: "):t.startsWith("leftover-vault-stars: ")&&(o=t.substring(22))}),""===o&&(o="0");let d=u.filter(e=>!e.startsWith("CurrentAlbumNumber: ")&&!e.startsWith("player-ign: ")&&!e.startsWith("player-link: ")&&!e.startsWith("leftover-vault-stars: ")&&!e.startsWith("IsPrestige: ")),p=d.join("\n");r=JSON.parse(p),Object.keys(r).forEach(t=>{let{id:n,...a}=r[t];parseInt(e.find(e=>e.GlobalID===n).AlbumNo)!==parseInt(CurrentAlbumNumber)?delete r[t]:r[t]={id:n,...Object.fromEntries(Object.entries(a).map(([e,t])=>[e,parseInt(t)]))}}),PlayerIGNInputComponent.value=a,PlayerLinkInputComponent.value=l,LeftoverVaultStarsInputComponent.value=o,userData=r,clearFilters();let g=document.querySelectorAll(".sticker-card-container");g.forEach(e=>{if(userData[e.getAttribute("data-global")])RestoreSelected(userData,e),RestoreStickerSpares(userData,e),RestoreTradeStates(userData,e),ChangeUserDataHaveSpareValue(userData,e);else{let t={...defaultValues,id:e.getAttribute("data-global")};userData[e.getAttribute("data-global")]=t}}),c===IgnorePrestige&&IgnorePrestigeBtnComponent.click(),countVaultStickers(),countSelectedStickers()}catch(m){console.error("Invalid JSON format:",m);return}"object"!=typeof userData||Array.isArray(userData)?(console.error("Invalid userData format. Expected an object."),CreateNewUserData()):console.log("Successfully imported userData:",userData)}function UpdateTotalStickerQuantity(){let t=0;e.filter(e=>e.AlbumNo===CurrentAlbumNumber).forEach(e=>{(1!==IgnorePrestige||"1"!==e.Prestige)&&t++}),TotalStickersQuantityTextSpan.textContent=t.toString()}function UpdateTotalStickerByRarityQuantity(){for(let t=1;t<=5;t++){let n=document.getElementById(`total-rarity${t}-quantity`),r=0;e.filter(e=>e.AlbumNo===CurrentAlbumNumber&&parseInt(e.StickerRarity)===t).forEach(e=>{(1!==IgnorePrestige||"1"!==e.Prestige)&&r++}),n.textContent=r.toString()}let a=0;e.forEach(e=>{(1!==IgnorePrestige||"1"!==e.Prestige)&&1===parseInt(e.Golden)&&e.AlbumNo===CurrentAlbumNumber&&a++}),TotalGoldQuantityTextSpan.textContent=a.toString()}function countSelectedStickers(){let t=new Map,n=Array.from(document.querySelectorAll(".progress-text span[data-setid]"));for(let r in n.forEach(e=>{e.textContent="0"}),userData){let a=userData[r].id,l=e.find(e=>e.GlobalID===a);if((1!==IgnorePrestige||"1"!==l.Prestige)&&userData.hasOwnProperty(r)&&1===userData[r].selected){let o=Math.floor(userData[r].id/100);t.has(o)?t.set(o,t.get(o)+1):t.set(o,1)}}let s=0;for(let[c,u]of t){let d=n.find(e=>e.getAttribute("data-setid")===c.toString());d&&(d.textContent=(parseInt(d.textContent,10)+u).toString()),s+=u}UserStickersQuantityTextSpan.textContent=s.toString(),countSelectedStickerByRarity(),updateProgressBar()}function countSelectedStickerByRarity(){for(let t=1;t<=5;t++)document.getElementById(`rarity${t}-quantity`).textContent=0,document.getElementById(`rarity${t}-percentage`).textContent=0;for(let n in GoldQuantityTextSpan.textContent=0,GoldPercentageTextSpan.textContent=0,userData){let r=userData[n].id,a=e.find(e=>e.GlobalID===r);if((1!==IgnorePrestige||"1"!==a.Prestige)&&userData.hasOwnProperty(n)&&1===userData[n].selected){let l=a.StickerRarity;document.getElementById(`rarity${l}-quantity`).textContent++,"1"===a.Golden&&GoldQuantityTextSpan.textContent++}}for(let o=1;o<=5;o++){let s=parseInt(document.getElementById(`rarity${o}-quantity`).textContent),c=parseInt(document.getElementById(`total-rarity${o}-quantity`).textContent),u=(s/c*100).toFixed(1);document.getElementById(`rarity${o}-percentage`).textContent=`${u}%`}let d=(parseInt(GoldQuantityTextSpan.textContent)/parseInt(TotalGoldQuantityTextSpan.textContent)*100).toFixed(1);GoldPercentageTextSpan.textContent=`${d}%`}function countVaultStickers(){let t=0;for(let n in userData){let r=userData[n].id,a=e.find(e=>e.GlobalID===r);if((1!==IgnorePrestige||"1"!==a.Prestige)&&userData.hasOwnProperty(n)&&userData[n].spare>0&&1===userData[n].selected){let l=e.find(e=>e.GlobalID===r);if(l){let o=userData[n].spare,s=parseInt(l.StickerRarity),c=parseInt(l.Golden);1===c?t+=o*s*2:t+=o*s}}}let u=LeftoverVaultStarsInputComponent.value;isNaN(u)&&(u=0);let d=t+parseInt(u);TotalVaultQuantityTextSpan.textContent=d.toString();let p=0,g="";NextVaultCounterTextSpan.style.display="block",d<250?(p=250-d,g="NextVaultCounterText_0",vaultTierImage.src=""):250<=d&&d<500?(p=500-d,g="NextVaultCounterText_1",vaultTierImage.src="assets/stickers/StickerVaultTier1.png"):500<=d&&d<700?(p=700-d,g="NextVaultCounterText_2",vaultTierImage.src="assets/stickers/StickerVaultTier2.png"):d>=700&&(p=d-700,vaultTierImage.src="assets/stickers/StickerVaultTier3.png",g="NextVaultCounterText_3"),NextVaultCounterTextSpan.setAttribute("data-translation-key",g),translateLanguage(CurrentLanguageCode,g);let m=NextVaultCounterTextSpan.textContent;if(m=m.replace("${StickersToNextTier}",p),d>=700){let f=Math.floor(d/700);(m=m.replace("${TierThreeVaultExchangeAmount}",f)).includes("${times}")&&(m=m.replace("${times}",0===f||f>1?"times":"time"))}NextVaultCounterTextSpan.textContent=m}function ChangeUserDataHaveSpareValue(e,t){let n=t.getAttribute("data-global");1===e[n].selected&&e[n].spare>0?e[n].havespare=1:e[n].havespare=0}function UpdateAlbumStartEndTime(){let e=n.find(e=>e.AlbumNo===CurrentAlbumNumber);AlbumIconContainerBlock.innerHTML=`<img draggable="false" class="album-logo" src="logo/album_${CurrentAlbumNumber}.png" alt="${e.ImageSource}"</img>`;let t=new Date(1e3*e.StartTime),r=new Date(1e3*e.EndTime),a=t.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),l=r.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return StartTimeTextSpan.textContent=a,EndTimeTextSpan.textContent=l,r}function updateTimeLeft(e){let t=new Date,n=e.getTime()-t.getTime();if(n<=0){let r=a.find(e=>"AlbumEndedText"===e["translation-key"])[CurrentLanguageCode];TimeLeftTextSpan.textContent=r,TimeLeftTextSpan.style.color=""}else{let l=Math.floor(n/864e5),o=Math.floor(n%864e5/36e5),s=Math.floor(n%36e5/6e4),c="";l>0&&(c+=`${l}d `),o>0&&(c+=`${o}h `),s>0&&(c+=`${s}m `),c+=`${Math.floor(n%6e4/1e3)}s`,TimeLeftTextSpan.textContent=c.trim(),n<=864e5?TimeLeftTextSpan.style.color="red":TimeLeftTextSpan.style.color=""}}stickerContainer.addEventListener("input",function(e){let t=e.target,n=t.closest(".sticker-card-container");if(t.classList.contains("spare-text")&&n){t.value=t.value.replace(/^0+(?=\d)/,"");let r=n.getAttribute("data-global");t.value>100?"100"===t.value.slice(0,-1)?t.value="100":t.value=t.value.slice(0,2):t.value<0?t.value=0:""===t.value&&setTimeout(()=>{""===t.value&&(t.value=0)},5e3),t.value>0&&!n.classList.contains("selected")&&(n.classList.add("selected"),n.classList.remove("not-selected"),userData[r].selected=1),countSelectedStickers(),UpdateCurrentAlbumStickerStates(r),ChangeUserDataHaveSpareValue(userData,n),ApplySelectedStyle(n),countVaultStickers()}}),SpareFilterMinInputComponent.addEventListener("input",handleFilterInput),SpareFilterMaxInputComponent.addEventListener("input",handleFilterInput),SpareFilterBtnComponent.addEventListener("click",()=>{SwapSpareFilterMinMax(),PerformFilters(userData)}),ImportBtnComponent.addEventListener("click",()=>{let e=ImportBtnComponent.querySelector("#import-btn-text"),t=ProfileTextAreaComponent.value.trim();importUserData(t),setTimeout(function(){let t=a.find(e=>"ImportSuccessful"===e["translation-key"])[CurrentLanguageCode];e.textContent=t,setTimeout(function(){e.textContent=a.find(e=>"import"===e["translation-key"])[CurrentLanguageCode]},3e3)},0)}),ImportFromFileBtnComponent.addEventListener("click",()=>{let e=document.createElement("input");e.type="file",e.accept=".txt",e.addEventListener("change",()=>{let t=e.files[0],n=new FileReader;n.onload=function(e){let t=e.target.result.trim();ProfileTextAreaComponent.value=t,importUserData(t)},n.readAsText(t);let r=ImportFromFileBtnComponent.querySelector("#import-from-file-btn-text");setTimeout(function(){let e=a.find(e=>"ImportSuccessful"===e["translation-key"])[CurrentLanguageCode];r.textContent=e,setTimeout(function(){r.textContent=a.find(e=>"LoadFromText"===e["translation-key"])[CurrentLanguageCode]},3e3)},0)}),e.click()}),ExportBtnComponent.addEventListener("click",()=>{exportUserData(!0);let e=ExportBtnComponent.querySelector("#export-btn-text");setTimeout(function(){let t=a.find(e=>"Saved"===e["translation-key"])[CurrentLanguageCode];e.textContent=t,setTimeout(function(){e.textContent=a.find(e=>"save"===e["translation-key"])[CurrentLanguageCode]},3e3)},0)}),ExportFromFileBtnComponent.addEventListener("click",()=>{exportUserData(!1);let e=new Blob([ProfileTextAreaComponent.value],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a"),l=new Date,o=l.getFullYear(),s=String(l.getMonth()+1).padStart(2,"0"),c=String(l.getDate()).padStart(2,"0"),u=String(l.getHours()).padStart(2,"0"),d=String(l.getMinutes()).padStart(2,"0"),p=String(l.getSeconds()).padStart(2,"0"),g=n.find(e=>e.AlbumNo===CurrentAlbumNumber),m=g[`AlbumName${CurrentLanguageCode}`].replace(/\s/g,"");r.download=`mogotools-userData_${m}_${o}${s}${c}_${u}${d}${p}.txt`,r.href=t,r.click();let f=ExportFromFileBtnComponent.querySelector("#export-from-file-btn-text");setTimeout(function(){let e=a.find(e=>"SaveAsTxtSuccessful"===e["translation-key"])[CurrentLanguageCode];f.textContent=e,setTimeout(function(){f.textContent=a.find(e=>"SaveAsText"===e["translation-key"])[CurrentLanguageCode]},3e3)},0)});let endDateTime=UpdateAlbumStartEndTime();function isBrighterThan(e,t){let n=calculateBrightness(e),r=calculateBrightness(t);return n>r}function calculateBrightness(e){let t=e.slice(1),n=parseInt(t,16);return(299*(n>>16&255)+587*(n>>8&255)+114*(255&n))/1e3}function DarkenColour(e,t){let n=(e=>{let t=parseInt(e.substring(1),16);return[t>>16&255,t>>8&255,255&t]})(e),r=((e,t)=>{let[n,r,a]=e;return[Math.floor(n*t),Math.floor(r*t),Math.floor(a*t)]})(n,1-t/100),a=(e=>{let[t,n,r]=e,a=e=>{let t=e.toString(16);return 1===t.length?0+t:t};return`#${a(t)}${a(n)}${a(r)}`})(r);return a}function handleSetImageOrientationBtnClick(e){!0===e&&(ImgOrientationLandscapeZeroPortraitOne=(ImgOrientationLandscapeZeroPortraitOne+1)%2),SetImageOrientationBtnComponent.setAttribute("data-translation-key",`SetImageOrientationBtnText_${ImgOrientationLandscapeZeroPortraitOne}`),translateLanguage(CurrentLanguageCode,`SetImageOrientationBtnText_${ImgOrientationLandscapeZeroPortraitOne}`)}updateTimeLeft(endDateTime),setInterval(()=>updateTimeLeft(endDateTime),1e3),SetImageOrientationBtnComponent.addEventListener("click",function(){handleSetImageOrientationBtnClick(!0)});let includeIGN=0,includePlayerLink=0;function copyToCollectionScreenshot(t){let n=document.getElementById(t);if(MiddleSideBlock&&n){n.innerHTML="";let r=MiddleSideBlock.innerHTML;n.style.backgroundColor="rgba(248, 244, 228)",n.setAttribute("style",MiddleSideBlock.getAttribute("style")),n.style.background='url("assets/background/Collections_Album_BG.png")',r=(r=r.replace(/sticker-card-container/g,"sticker-card-container-screenshot")).replace(/trade-button-container/g,"trade-button-container-screenshot"),n.innerHTML=r;let a=n.querySelectorAll(".sticker-card-container-screenshot");a.forEach(function(t){t.querySelector(".trade-button-container-screenshot").style.width="100%",t.querySelector(".trade-button-container-screenshot").style.display="flex";let r=t.getAttribute("data-global"),a=document.createElement("span");a.className="spare-text-screenshot",a.textContent=userData[r].spare;let l=t.querySelector(".spare-text");l&&l.parentNode.replaceChild(a,l);let o=t.querySelector(".spare-spinner-container");if(o&&o.parentNode.removeChild(o),userData[r].spare>0){let s=e.find(e=>e.GlobalID===r),c="Collections_TradingGroup_NumberBG_Small.png",u=document.createElement("div");u.className="spare-container-no-spinner";let d="spare-snapshot-text";if("1"===s.Golden&&(c="GoldenBlitz_Stickers_Badge01.png",u.className="spare-container-no-spinner-golden",d="spare-snapshot-text-golden"),u.innerHTML=`
          <img draggable="false" class="spare-img" src="assets/stickers/${c}">
          <span class="${d}">+${userData[r].spare}</span>
        `,t.querySelector(".sticker-ribbon")){let p=t.querySelector(".sticker-ribbon").parentNode;p.insertBefore(u,t.querySelector(".sticker-ribbon"))}if(t.querySelector(".sticker-ribbon-transparent")){let g=t.querySelector(".sticker-ribbon-transparent").parentNode;g.insertBefore(u,t.querySelector(".sticker-ribbon-transparent"))}if(navigator.userAgent.indexOf("Safari")>-1){let m=t.querySelector(".spare-snapshot-text");m.style.marginTop=parseInt(m.style.marginTop)+1+"px";let f="";t.querySelector(".sticker-ribbon")&&(f=t.querySelector(".sticker-ribbon")),t.querySelector(".sticker-ribbon-transparent")&&(f=t.querySelector(".sticker-ribbon-transparent")),f.style.marginTop=parseInt(f.style.marginTop)+1+"px"}}t.querySelector(".sticker-ribbon")&&(t.querySelector(".sticker-ribbon").style.transform="translate(0, 306%)"),t.querySelector(".spare-container-no-spinner")&&(t.querySelector(".spare-container-no-spinner").style.transform="translate(0, 87px)"),t.querySelector(".spare-container-no-spinner-golden")&&(t.querySelector(".spare-container-no-spinner-golden").style.transform="translate(0, 87px)"),0===userData[r].selected&&(t.querySelector(".spare-container-no-spinner")&&(t.querySelector(".spare-container-no-spinner").style.transform="translate(0, 95px)"),t.querySelector(".spare-container-no-spinner-golden")&&(t.querySelector(".spare-container-no-spinner-golden").style.transform="translate(0, 95px)"));let S=!0,y=n.querySelectorAll(".trade-button-container-screenshot");if(y.forEach(function(e){let t=e.querySelectorAll(".lf-btn");t.forEach(function(e){e.classList.contains("btnRed")||(S=!1)})}),S){let b=n.querySelectorAll(".sticker-card-container-screenshot");b.forEach(function(e){e.style.opacity="1.0"})}})}else console.log("Either middle-side or collection-screenshot element is not found.")}function copyToTradeScreenshot(t,n){let r=document.getElementById(t);if(r.style.alignContent="",CurrentStickerBoardBlock&&r){r.innerHTML="",r.style.backgroundColor="rgba(248, 244, 228)";let l=document.createDocumentFragment(),o=e.filter(e=>e.GlobalID in userData&&1===userData[e.GlobalID][n]&&1===userData[e.GlobalID].show).sort((e,t)=>e.Golden>t.Golden?-1:e.Golden<t.Golden?1:e.StickerRarity>t.StickerRarity?-1:e.StickerRarity<t.StickerRarity?1:e.GlobalID<t.GlobalID?-1:e.GlobalID>t.GlobalID?1:0);if(0===o.length){let s=a.find(e=>"None"===e["translation-key"])[CurrentLanguageCode];r.innerHTML=`<span class="lfft-snapshot-none" data-translation-key="none">${s}</span>`,r.style.alignContent="center";return}{for(let c of o){let u=userData[c.GlobalID],d=u.id,p=e.find(e=>e.GlobalID===d);if(1!==IgnorePrestige||"1"!==p.Prestige){if(0!==u[n]){{let g=CreateStickerElement(c,"sticker-card-container","sticker-card",!0);l.appendChild(g)}r.appendChild(l)}}}r.innerHTML=r.innerHTML.replace(/sticker-card-container/g,"sticker-card-container-screenshot");let m=r.querySelectorAll(".sticker-card-container-screenshot");m.forEach(function(t){let r=t.getAttribute("data-global"),a=document.createElement("span");a.className="spare-text-screenshot",a.textContent=userData[r].spare;let l=t.querySelector(".spare-text");if(0===userData[r][n])t.remove();else{t.style.opacity="1.0",t.querySelector(".trade-button-container").remove(),l&&l.parentNode.replaceChild(a,l);let o=t.querySelector(".spare-spinner-container");if(o&&o.parentNode.removeChild(o),userData[r].spare>0){let s=e.find(e=>e.GlobalID===r),c="Collections_TradingGroup_NumberBG_Small.png",u=document.createElement("div");u.className="spare-container-no-spinner";let d="spare-snapshot-text";if("1"===s.Golden&&(c="GoldenBlitz_Stickers_Badge01.png",u.className="spare-container-no-spinner-golden",d="spare-snapshot-text-golden"),u.innerHTML=`
              <img draggable="false" class="spare-img" src="assets/stickers/${c}">
              <span class="${d}">+${userData[r].spare}</span>
            `,t.querySelector(".sticker-ribbon")){let p=t.querySelector(".sticker-ribbon").parentNode;p.insertBefore(u,t.querySelector(".sticker-ribbon"))}if(t.querySelector(".sticker-ribbon-transparent")){let g=t.querySelector(".sticker-ribbon-transparent").parentNode;g.insertBefore(u,t.querySelector(".sticker-ribbon-transparent"))}if(navigator.userAgent.indexOf("Safari")>-1){let m=t.querySelector(".spare-snapshot-text");m.style.marginTop=parseInt(m.style.marginTop)+1+"px";let f="";t.querySelector(".sticker-ribbon")&&(f=t.querySelector(".sticker-ribbon")),t.querySelector(".sticker-ribbon-transparent")&&(f=t.querySelector(".sticker-ribbon-transparent")),f.style.marginTop=parseInt(f.style.marginTop)+1+"px"}}t.querySelector(".sticker-ribbon")&&(t.querySelector(".sticker-ribbon").style.transform="translate(0, 306%)"),t.querySelector(".spare-container-no-spinner")&&(t.querySelector(".spare-container-no-spinner").style.transform="translate(0, 87px)"),t.querySelector(".spare-container-no-spinner-golden")&&(t.querySelector(".spare-container-no-spinner-golden").style.transform="translate(0, 87px)"),0===userData[r].selected&&1===StickerSelectedZeroShowOneBack&&(t.querySelector(".spare-container-no-spinner")&&(t.querySelector(".spare-container-no-spinner").style.transform="translate(0, 95px)"),t.querySelector(".spare-container-no-spinner-golden")&&(t.querySelector(".spare-container-no-spinner-golden").style.transform="translate(0, 95px)"))}}),1===ImgOrientationLandscapeZeroPortraitOne&&(r.style.width="440px")}}else console.log("Either middle-side or collection-screenshot element is not found.")}function ResizeElementBeforeCapture(e){let t,n,r,a;(r=(t=e.offsetWidth)*(n=e.offsetHeight))>1579008&&(a=Math.sqrt(1579008/r),e.style.transform=`scale(${a})`,e.style.transformOrigin="top left")}function captureScreenshot(e){let t=document.getElementById(e);t?html2canvas(t,{scale:2,useCORS:!0}).then(function(e){let t=new Date,r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0"),c=String(t.getSeconds()).padStart(2,"0"),u=n.find(e=>e.AlbumNo===CurrentAlbumNumber),d=u[`AlbumName${CurrentLanguageCode}`].replace(/\s/g,"");if(navigator.userAgent.indexOf("Safari")>-1)e.toBlob(function(e){let t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`mogotools-screenshot_${d}_${r}${a}${l}_${o}${s}${c}.png`,t.click()});else{let p=e.toDataURL("image/png"),g=document.createElement("a");g.href=p,g.download=`mogotools-screenshot_${d}_${r}${a}${l}_${o}${s}${c}.png`,g.click()}}).catch(function(e){console.error("Error:",e)}):console.log("collection-screenshot element is not found.")}function handleViewportBtnClick(e){!0===e&&(WebZeroMobileOne=(WebZeroMobileOne+1)%2),0===WebZeroMobileOne?(DefaultCSSSheet.removeAttribute("disabled"),MobileCSSSheet.setAttribute("disabled",!0),ProgressMenuModal.style.display="initial",FilterSortModal.style.display="initial"):1===WebZeroMobileOne&&(DefaultCSSSheet.setAttribute("disabled",!0),MobileCSSSheet.removeAttribute("disabled"),FilterSortModal.style.display="none",ProgressMenuModal.style.display="none"),ViewportBtnTextSpan.setAttribute("data-translation-key",`ViewportBtnText_${WebZeroMobileOne}`),translateLanguage(CurrentLanguageCode,`ViewportBtnText_${WebZeroMobileOne}`)}function compareViewport(){let e=window.innerWidth,t=window.innerHeight;e>t?(WebZeroMobileOne=0,ImgOrientationLandscapeZeroPortraitOne=0):(WebZeroMobileOne=1,ImgOrientationLandscapeZeroPortraitOne=1),handleViewportBtnClick(!1),handleSetImageOrientationBtnClick(!1)}function handleLayoutThemeBtnClick(e){!0===e&&(LightZeroDarkOne=(LightZeroDarkOne+1)%2),0===LightZeroDarkOne?LayoutBtnTextSpan.textContent="Dark Mode":1===LightZeroDarkOne&&(LayoutBtnTextSpan.textContent="Light Mode")}function generateCurrentFiltersModalText(){CurrentFiltersContentBlock.innerHTML="";let e=[],t=[];for(let n of Object.values(FilterList)){let r=n.FilterName,a=n.FilterState,l=n.FilterValue;if(1===a){if("1>StickerName>"===r)Array.isArray(l)&&e.push(...l.map(e=>`<span data-translation-key="IS"></span> "${e}"`));else if("0>spare>spare-filter-min|spare-filter-max"!==r){let o=document.querySelector(`button[data-filtervalue="${r}"]`);o&&e.push(`<span data-translation-key="IS"></span> ${o.innerHTML}`)}}else if(2===a){if("1>StickerName>"===r)Array.isArray(l)&&t.push(...l.map(e=>`<span data-translation-key="NOT"></span> "${e}"`));else if("0>spare>spare-filter-min|spare-filter-max"!==r){let s=document.querySelector(`button[data-filtervalue="${r}"]`);s&&t.push(`<span data-translation-key="NOT"></span> ${s.innerHTML}`)}}}let c=FilterList["0>spare>spare-filter-min|spare-filter-max"].FilterState,u=e.length>0?`<b><span data-translation-key="IncludeFilters"></span></b><br><ul>
${e.map(e=>`<li>${e}</li>`).join("\n")}
</ul>`:"",d=t.length>0?`<b><span data-translation-key="ExcludeFilters"></span></b><br><ul>
${t.map(e=>`<li>${e}</li>`).join("\n")}
</ul>`:"",p=Object.keys(userData).filter(e=>1===userData[e].show).length;CurrentFiltersContentBlock.innerHTML=`<span data-translation-key="ViewCurrentFiltersBtn_CurrentFilterModeText_${AndZeroOrOne}"></span><br><br><span data-translation-key="ViewCurrentFiltersBtn_FoundText"></span>&nbsp;${p}&nbsp;<span data-translation-key="ViewCurrentFiltersBtn_StickerText"></span><br><br><span data-translation-key="ViewCurrentFiltersBtn_CurrentFilterDescription_FilterMode${AndZeroOrOne}_SpareFilter${c}"></span><br><br>${u}<br>${d}`;let g=CurrentFiltersContentBlock.querySelectorAll("[data-translation-key]");g.forEach(e=>{let t=e.dataset.translationKey;translateLanguage(CurrentLanguageCode,t)}),CurrentFiltersContentBlock.innerHTML.includes("${spareMinValue}")&&CurrentFiltersContentBlock.innerHTML.includes("${spareMaxValue}")&&(CurrentFiltersContentBlock.innerHTML=CurrentFiltersContentBlock.innerHTML.replace("${spareMinValue}",SpareFilterMinInputComponent.value).replace("${spareMaxValue}",SpareFilterMaxInputComponent.value))}function GenerateTradePostClipboard(){TradePostTextAreaComponent.value="";let t=[],n=[],r=new Set,l=new Set,o=(t,n,r,a)=>{let l=t.id,o=e.find(e=>e.GlobalID===l),s=t.spare;if(o){let{SetID:c,AlbumNo:u,GlobalID:d,StickerRarity:p,Golden:g}=o,m=o[`StickerName${CurrentLanguageCode}`],f=s>0?`(x${s})`:"",S=`- ${m}, Set ${c-100*u}, ${p}★${"1"===g?a:""} ${f}
`;n.push(S),r.add(p)}};for(let s in userData)1===userData[s].lookingfor&&1===userData[s].show&&o(userData[s],t,r,"(G)"),1===userData[s].fortrade&&1===userData[s].show&&o(userData[s],n,l,"(G)");let c=(e,t)=>{e.sort((e,n)=>{let r=e.includes(t),a=n.includes(t);if(r!==a)return a-r;let l=Number(e.split("★")[0].split(",")[2]),o=Number(n.split("★")[0].split(",")[2]);if(l!==o)return o-l;let s=Number(e.split("Set ")[1].split(" #")[0]),c=Number(n.split("Set ")[1].split(" #")[0]);return s-c})};c(t,"(G)"),c(n,"(G)");let u=a.find(e=>"LookingFor_TradePost"===e["translation-key"])[CurrentLanguageCode],d=a.find(e=>"ForTrade_TradePost"===e["translation-key"])[CurrentLanguageCode],p=a.find(e=>"TradePostMessage"===e["translation-key"])[CurrentLanguageCode],g="";if(1===r.size&&1===l.size&&[...r][0]===[...l][0]){let m=[...r][0];g+=`${m}★

`,t=t.map(e=>e.replace(`, ${m}★`," ")),n=n.map(e=>e.replace(`, ${m}★`," "))}g+=`${u}
${t.join("")}
${d}
${n.join("")}
${p}`,TradePostTextAreaComponent.value=g}function copyTradePostAreaToClipboard(){let e=TradePostTextAreaComponent.value;navigator.clipboard.writeText(e).then(()=>{CopyTradePostAreaBtnComponent.classList.add("btnYellowTransition");let e=a.find(e=>"copied"===e["translation-key"])[CurrentLanguageCode];CopyTradePostAreaBtnTextSpan.textContent=e,setTimeout(()=>{CopyTradePostAreaBtnComponent.classList.remove("btnYellowTransition");let e=a.find(e=>"copy"===e["translation-key"])[CurrentLanguageCode];CopyTradePostAreaBtnTextSpan.textContent=e},3e3)}).catch(e=>{console.error("Failed to copy text: ",e)})}function handleVaultPrestigeInput(e){let t=e.target;if(t.classList.contains("vault-prestige-text")){if(t.value=t.value.replace(/^0+(?=\d)/,""),t.value>9999)"9999"===t.value.slice(0,-1)?t.value="9999":t.value=t.value.slice(0,4);else if(t.value<0)t.value=0;else if(""===t.value){setTimeout(()=>{""===t.value&&(t.value=0,countVaultStickers())},5e3);return}}countVaultStickers()}IncludePlayerIGNBtnComponent.addEventListener("click",function(){1==(includeIGN=(includeIGN+1)%2)?IncludePlayerIGNBtnComponent.classList.add("btnGreen"):IncludePlayerIGNBtnComponent.classList.remove("btnGreen")}),IncludePlayerLinkBtnComponent.addEventListener("click",function(){1==(includePlayerLink=(includePlayerLink+1)%2)?IncludePlayerLinkBtnComponent.classList.add("btnGreen"):IncludePlayerLinkBtnComponent.classList.remove("btnGreen")}),dlPngButtonComponent&&(CollectionScreenshotBlock.style.display="initial",TradeScreenshotBlock.style.display="none",dlPngButtonComponent.addEventListener("click",function(){CollectionScreenshotBlock.innerHTML="";let e=a.find(e=>"Downloading"===e["translation-key"])[CurrentLanguageCode],t=dlPngButtonComponent.querySelector("#dl-png-btn-text");t.textContent=e,dlPngButtonComponent.classList.add("btnYellowTransition"),1===ImgOrientationLandscapeZeroPortraitOne?SnapshotAreaBlock.style.width="400px":SnapshotAreaBlock.style.width="1200px",copyToCollectionScreenshot("collection-screenshot");let r="",l="";1===includeIGN&&(r=PlayerIGNInputComponent.value),1===includePlayerLink&&(l=PlayerLinkInputComponent.value);let o=n.find(e=>e.AlbumNo===CurrentAlbumNumber),s=o[`AlbumName${CurrentLanguageCode}`],c=`
    <div id="collection-screenshot-player-info">
      <div id="collection-screenshot-player-name">${r}</div>
      <div id="collection-screenshot-my-album">${s}</div>
      <div id="collection-screenshot-player-link">${l}</div>
    </div>
    `,u=Math.floor(Date.now()/1e3),d=`<div id="collection-screenshot-footer"><div id="collection-screenshot-footer-time">${u}</div><div id="collection-screenshot-footer-link">https://mogotools.web.app/</div></div>`,p=CollectionScreenshotBlock;p.innerHTML=c+p.innerHTML+d,ResizeElementBeforeCapture(CollectionScreenshotBlock),captureScreenshot("collection-screenshot"),CollectionScreenshotBlock.innerHTML="",CollectionScreenshotBlock.style.display="none",setTimeout(function(){let e=a.find(e=>"DownloadSuccessful"===e["translation-key"])[CurrentLanguageCode];t.textContent=e,setTimeout(function(){dlPngButtonComponent.classList.remove("btnYellowTransition");let e=a.find(e=>"DownloadPNGBtnText"===e["translation-key"])[CurrentLanguageCode];t.textContent=e},3e3)},3e3)})),dlTradePngButtonComponent&&dlTradePngButtonComponent.addEventListener("click",function(){document.getElementById("collection-screenshot").style.display="none",document.getElementById("trade-screenshot").style.display="initial",document.getElementById("trade-screenshot-container").setAttribute("style",""),document.getElementById("fortrade-screenshot-area").style.height="",document.getElementById("lookingfor-screenshot-area").style.height="",document.getElementById("fortrade-screenshot-area").innerHTML="",document.getElementById("lookingfor-screenshot-area").innerHTML="";let e=a.find(e=>"Downloading"===e["translation-key"])[CurrentLanguageCode],t=document.querySelector("#dl-trade-png-btn-text");t.textContent=e,dlTradePngButtonComponent.classList.add("btnYellow"),copyToTradeScreenshot("fortrade-screenshot-area","fortrade"),copyToTradeScreenshot("lookingfor-screenshot-area","lookingfor"),document.getElementById("fortrade-screenshot-area").style.width="400px",document.getElementById("fortrade-screenshot-area").style.background="",document.getElementById("lookingfor-screenshot-area").style.width="400px",document.getElementById("lookingfor-screenshot-area").style.background="",document.getElementById("fortrade-screenshot-area").innerHTML=document.getElementById("fortrade-screenshot-area").innerHTML.replace(/sticker-card-container-screenshot/g,"sticker-card-container-screenshot-trade"),document.getElementById("lookingfor-screenshot-area").innerHTML=document.getElementById("lookingfor-screenshot-area").innerHTML.replace(/sticker-card-container-screenshot/g,"sticker-card-container-screenshot-trade");var n,r="",l="";1===includeIGN&&(r=document.getElementById("player-ign").value),1===includePlayerLink&&(l=document.getElementById("player-link").value);let o=Math.floor(Date.now()/1e3),s=a.find(e=>"MyTrade"===e["translation-key"])[CurrentLanguageCode];if(document.getElementById("collection-screenshot-player-info")&&document.getElementById("collection-screenshot-footer"))document.getElementById("collection-screenshot-player-info").outerHTML=`
        <div id="collection-screenshot-player-info" style="width: 440px">
        <div id="collection-screenshot-player-name">${r}</div>
        <div id="collection-screenshot-my-album">${s}</div>
        <div id="collection-screenshot-player-link">${l}</div>
      </div>
      `,document.getElementById("collection-screenshot-footer").outerHTML=`
      <div id="collection-screenshot-footer" style="width: 440px"><div id="collection-screenshot-footer-gamever">${o}</div><div id="collection-screenshot-footer-link">https://mogotools.web.app/</div></div>
      `;else{var c=`
      <div id="collection-screenshot-player-info" style="width: 440px">
        <div id="collection-screenshot-player-name">${r}</div>
        <div id="collection-screenshot-my-album">${s}</div>
        <div id="collection-screenshot-player-link">${l}</div>
      </div>
      `,u=`<div id="collection-screenshot-footer" style="width: 440px"><div id="collection-screenshot-footer-gamever">${o}</div><div id="collection-screenshot-footer-link">https://mogotools.web.app/</div></div>`,d=document.getElementById("trade-screenshot");d.innerHTML=c+d.innerHTML+u}if(0===ImgOrientationLandscapeZeroPortraitOne){document.getElementById("trade-screenshot-container").style.display="flex",document.getElementById("trade-screenshot-container").style.justifyContent="center",document.getElementById("trade-screenshot-container").style.columnGap="30px",document.getElementById("collection-screenshot-player-info").style.width="900px",document.getElementById("collection-screenshot-footer").style.width="900px",document.getElementById("fortrade-screenshot-area").scrollHeight>document.getElementById("lookingfor-screenshot-area").scrollHeight?document.getElementById("lookingfor-screenshot-area").style.height="100%":document.getElementById("fortrade-screenshot-area").style.height="100%"}document.getElementById("trade-screenshot").style.background='url("assets/background/Collections_Album_BG.png")',ResizeElementBeforeCapture(document.getElementById("trade-screenshot")),captureScreenshot("trade-screenshot"),document.getElementById("fortrade-screenshot-area").innerHTML="",document.getElementById("lookingfor-screenshot-area").innerHTML="",document.getElementById("trade-screenshot").style.display="none",setTimeout(function(){let e=a.find(e=>"DownloadSuccessful"===e["translation-key"])[CurrentLanguageCode];t.textContent=e,setTimeout(function(){dlTradePngButtonComponent.classList.remove("btnYellow");let e=a.find(e=>"DownloadTradePNGBtnText"===e["translation-key"])[CurrentLanguageCode];t.textContent=e},3e3)},3e3)}),ViewportBtnComponent.addEventListener("click",function(){handleViewportBtnClick(!0)}),LayoutBtnComponent.addEventListener("click",function(){handleLayoutThemeBtnClick(!0)}),FilterSortMenuMobileOpenBtn.onclick=function(){FilterSortModal.style.display="block"},FilterSortMenuMobileCloseBtn.onclick=function(){FilterSortModal.style.display="none"},ProgressMenuMobileOpenBtn.onclick=function(){ProgressMenuModal.style.display="block"},ProgressMenuMobileCloseBtn.onclick=function(){ProgressMenuModal.style.display="none"},CurrentFiltersOpenBtn.onclick=function(){CurrentFiltersModal.style.display="block",generateCurrentFiltersModalText()},CurrentFiltersCloseBtn.onclick=function(){CurrentFiltersModal.style.display="none"},ManageProfileOpenBtn.onclick=function(){ManageProfileModal.style.display="block",OpenManageProfileMenu()},ManageProfileCloseBtn.onclick=function(){ManageProfileModal.style.display="none"},BasicMenuMobileOpenBtn.onclick=function(){BasicMenuModal.style.display="block"},BasicMenuWebOpenBtn.onclick=function(){BasicMenuModal.style.display="block"},BasicMenuMobileCloseBtn.onclick=function(){BasicMenuModal.style.display="none"},window.onclick=function(e){e.target===FilterSortModal&&(FilterSortModal.style.display="none"),e.target===ProgressMenuModal&&(ProgressMenuModal.style.display="none"),e.target===BasicMenuModal&&(BasicMenuModal.style.display="none"),e.target===CurrentFiltersModal&&(CurrentFiltersModal.style.display="none"),e.target===ManageProfileModal&&(ManageProfileModal.style.display="none")},GenerateTradePostBtnComponent.addEventListener("click",function(){GenerateTradePostClipboard()}),CopyTradePostAreaBtnComponent.addEventListener("click",copyTradePostAreaToClipboard),ToggleSelectedBtnComponent.onclick=function(){let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{let t=e.getAttribute("data-global");userData[t].selected=(userData[t].selected+1)%2,RestoreSelected(userData,e)}),countSelectedStickers()},ResetSparesBtnComponent.onclick=function(){let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{let t=e.getAttribute("data-global");userData[t].spare=0,RestoreStickerSpares(userData,e),ChangeUserDataHaveSpareValue(userData,e)}),countVaultStickers()},ToggleLFBtnComponent.onclick=function(){console.log("hi");let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{let t=e.getAttribute("data-global");userData[t].lookingfor=(userData[t].lookingfor+1)%2,RestoreTradeStates(userData,e)})},ToggleFTBtnComponent.onclick=function(){let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{let t=e.getAttribute("data-global");userData[t].fortrade=(userData[t].fortrade+1)%2,RestoreTradeStates(userData,e)})},ResetLFBtnComponent.onclick=function(){let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{let t=e.getAttribute("data-global");userData[t].lookingfor=0,RestoreTradeStates(userData,e)})},ResetFTBtnComponent.onclick=function(){let e=document.querySelectorAll(".sticker-card-container");e.forEach(e=>{let t=e.getAttribute("data-global");userData[t].fortrade=0,RestoreTradeStates(userData,e)})},ResetAllStickersBtnComponent.onclick=function(){CreateNewUserData(e),clearFilters();let t=document.querySelectorAll(".sticker-card-container");t.forEach(e=>{RestoreSelected(userData,e),RestoreStickerSpares(userData,e),RestoreTradeStates(userData,e)}),countSelectedStickers(),countVaultStickers(),generateCurrentStickerBoard(e,userData,"current-sticker-board")},LeftoverVaultStarsInputComponent.addEventListener("input",handleVaultPrestigeInput);for(let i=0;i<AccordionElementGroup.length;i++)AccordionElementGroup[i].addEventListener("click",function(){this.classList.toggle("active");let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"});function handleBasicMenuNavigationClick(e){for(let t=0;t<BasicMenuNavBtnElementGroup.length;t++)BasicMenuNavBtnElementGroup[t].classList.remove("basic-menu-navigation-btn-selected");e.target.classList.add("basic-menu-navigation-btn-selected");let n="";"BasicMenuNewsBtn"===e.target.id?n="news-content":"BasicMenuFAQBtn"===e.target.id?n="faq-info-content":"BasicMenuDisplayBtn"===e.target.id&&(n="display-settings-content");for(let r=0;r<BasicMenuSubcontainerElementGroup.length;r++)BasicMenuSubcontainerElementGroup[r].id===n?BasicMenuSubcontainerElementGroup[r].style.display="initial":BasicMenuSubcontainerElementGroup[r].style.display="none"}for(let k=0;k<BasicMenuNavBtnElementGroup.length;k++)BasicMenuNavBtnElementGroup[k].addEventListener("click",handleBasicMenuNavigationClick);let webBasicMenuImg=document.querySelector(".webBasicMenuImg");function LoadNews(){let e=Math.floor(new Date().getTime()/1e3),t=r.filter(t=>t.NewsTime<=e).sort((e,t)=>t.NewsTime-e.NewsTime);t.forEach(e=>{let{NewsTime:t,NewsHeader:n,NewsContent:r}=e,a=`
      <div class="basic-menu-news-item">
        <div class="basic-menu-news-item-header">
          <span class="news-item-time">${convertEpochToYYYYMMDD(parseInt(t))}</span> - ${n}
        </div>
        <div class="basic-menu-news-item-content">${r}</div>
      </div><br>
    `;NewsContentBlock.innerHTML+=a});let n=t.some(t=>{let{NewsTime:n}=t;return e-n<=86400});n&&(0===WebZeroMobileOne?BasicMenuWebOpenBtn.click():1===WebZeroMobileOne&&BasicMenuMobileOpenBtn.click())}function convertEpochToYYYYMMDD(e){let t=parseInt(e,10),n=new Date(1e3*t),r=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0"),o=`${r}/${a}/${l}`;return o}function handleChangeStickerStyleBtn(e){!0===e&&(StickerSelectedZeroShowOneBack=(StickerSelectedZeroShowOneBack+1)%2),ChangeStickerStyleBtnTextSpan.setAttribute("data-translation-key",`ChangeStickerStyleBtnText_${StickerSelectedZeroShowOneBack}`),translateLanguage(CurrentLanguageCode,`ChangeStickerStyleBtnText_${StickerSelectedZeroShowOneBack}`)}function translateLanguage(e,t){let n=document.querySelectorAll("[data-translation-key]");n.forEach(n=>{let r=n.dataset.translationKey;if(r===t){let l=a.find(e=>e["translation-key"]===r),o=l?l[e]:"";"TEXTAREA"===n.tagName?n.placeholder=o:"INPUT"===n.tagName?n.placeholder=o:n.textContent=o}})}function TranslateSetName(e){let n=document.querySelectorAll("span.SetNameText[data-setid]");n.forEach(n=>{let r=n.getAttribute("data-setid"),a=t.find(e=>e.SetID===r);if(a&&n.classList.contains("SetNameText")){let l=a[`SetName${e}`];n.textContent=l;let o="set-name";l.length>=15?o="set-name-long-min15":l.length>=18&&(o="set-name-long-min18"),isBrighterThan(a.Colour,"#CCCCCC")&&(o+="-dark"),n.parentElement.className=o}})}function TranslateStickerName(t,n){let r=t.querySelector("span.StickerNameText[data-stickerid]"),a=r.getAttribute("data-stickerid"),l=e.find(e=>e.GlobalID===a);if(l&&r.classList.contains("StickerNameText")){let o=l[`StickerName${n}`];r.textContent=o;let s="sticker-name";o.length>=14?s="sticker-name-long-min14":o.length>=18&&(s="sticker-name-long-min18"),isBrighterThan(l.Colour,"#CCCCCC")&&(s+="-dark"),r.parentElement.className=s}}function GenerateChangeAlbumButtons(){n.forEach(e=>{let t=document.createElement("button");t.classList.add("change-album-btn","btn"),t.setAttribute("type","button"),t.setAttribute("data-album-number",e.AlbumNo);let n=`
      <span><span data-translation-key="album"></span>&nbsp;${e.AlbumNo}</span>
    `;t.innerHTML=n,ChangeAlbumMenuBlock.appendChild(t)}),translateLanguage(CurrentLanguageCode,"album");let t=document.querySelectorAll(".change-album-btn");t.forEach(n=>{n.addEventListener("mousedown",()=>{n.classList.add("scale-down"),n.classList.add("btnYellowTransition")}),n.addEventListener("mouseup",()=>{n.classList.remove("scale-down"),n.classList.remove("btnYellowTransition")}),n.addEventListener("mouseleave",()=>{n.classList.remove("scale-down"),n.classList.remove("btnYellowTransition")}),n.addEventListener("touchstart",()=>{n.classList.add("scale-down"),n.classList.add("btnYellowTransition")}),n.addEventListener("touchend",()=>{n.classList.remove("scale-down"),n.classList.remove("btnYellowTransition")}),n.addEventListener("click",function(){clearFilters(),ResetAllStickersBtnComponent.click(),1===IgnorePrestige&&IgnorePrestigeBtnComponent.click(),CurrentAlbumNumber=this.dataset.albumNumber,CurrentStickerBoardBlock.innerHTML="",CreateNewUserData(e),GenerateFilterSetButtons(),SetDefaultFilterStates(),generateCurrentStickerBoard(e,userData,"current-sticker-board"),document.querySelector(`button[data-translation-pointer= ${CurrentLanguageCode}]`).click(),PerformSort({currentTarget:document.querySelector("button[data-sort-type='GlobalID']")}),NotSelectedByDefault(),UpdateTotalStickerQuantity(),UpdateTotalStickerByRarityQuantity(),countSelectedStickers(),countVaultStickers(),endDateTime=UpdateAlbumStartEndTime(),t.forEach(e=>e.classList.remove("btnBlue")),this.classList.add("btnBlue")})})}function SaveToProfileList(){let e=Date.now(),t=PlayerIGNInputComponent.value,n=PlayerLinkInputComponent.value,r=LeftoverVaultStarsInputComponent.value,a=(IgnorePrestige+1)%2,l={ProfileAlbumNumber:CurrentAlbumNumber,ProfileIsPrestige:a,ProfilePlayerIGN:t,ProfilePlayerLink:n,ProfileLeftoverVaultStars:r,ProfileLastModifiedTime:e,ProfileUserData:userData};UserProfileList.push(l),localStorage.setItem("UserProfileList",JSON.stringify(UserProfileList)),UserProfileList.sort((e,t)=>t.ProfileLastModifiedTime-e.ProfileLastModifiedTime),console.log(UserProfileList)}function OpenManageProfileMenu(){UserProfileList.sort((e,t)=>t.ProfileLastModifiedTime-e.ProfileLastModifiedTime),ProfileListBlock.innerHTML="",UserProfileList.forEach(e=>{let t=e.ProfileAlbumNumber,r=e.ProfileIsPrestige,a="";1===r?a="Yes":(r=0,a="No");let l=e.ProfilePlayerIGN,o=convertEpochToYYYYMMDDHHMMSS(parseInt(e.ProfileLastModifiedTime)),s=n.find(e=>e.AlbumNo===t),c=s[`AlbumName${CurrentLanguageCode}`],u=s.Colour,d=UserProfileList.indexOf(e)+1,p=`
      <div class="profile-block" data-profile-time="${e.ProfileLastModifiedTime}">
        <div class="profile-info-container">
          <div class="profile-info-container-name">【${d}】&emsp;${l}</div>
          <div class="profile-info-container-album" style="background-color: ${u}"><span data-translation-key="album"></span>&nbsp;${t} - ${c}</div>
          <div class="profile-info-container-prestige"><span><span data-translation-key="IsPrestige"></span>&emsp;</span><span data-translation-key="${a}"></span></div>
          <div class="profile-info-container-time"><span><span data-translation-key="LastModified"></span>&emsp;</span>${o}</div>
        </div>
        <div class="profile-options-container">
          <button class="btn profile-options-btn btnYellow LoadProfileBtn"><span data-translation-key="LoadProfileButtonText"></span></button>
          <button class="btn profile-options-btn btnGreen DownloadProfileBtn"><span data-translation-key="DownloadProfileButtonText"></span></button>
          <button class="btn profile-options-btn btnRed DeleteProfileBtn"><span data-translation-key="DeleteProfileButtonText"></span></button>
        </div>
      </div>
    `;ProfileListBlock.innerHTML+=p,translateLanguage(CurrentLanguageCode,a)}),translateLanguage(CurrentLanguageCode,"album"),translateLanguage(CurrentLanguageCode,"LoadProfileButtonText"),translateLanguage(CurrentLanguageCode,"DownloadProfileButtonText"),translateLanguage(CurrentLanguageCode,"DeleteProfileButtonText"),translateLanguage(CurrentLanguageCode,"LastModified"),translateLanguage(CurrentLanguageCode,"IsPrestige");let e=document.querySelectorAll(".profile-options-btn");e.forEach(e=>{e.addEventListener("mousedown",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("mouseup",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("mouseleave",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")}),e.addEventListener("touchstart",()=>{e.classList.add("scale-down"),e.classList.add("btnYellowTransition")}),e.addEventListener("touchend",()=>{e.classList.remove("scale-down"),e.classList.remove("btnYellowTransition")})})}function convertEpochToYYYYMMDDHHMMSS(e){let t=new Date(e),n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),l=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return`${n}/${r}/${a} ${l}:${o}:${s}`}webBasicMenuImg&&(webBasicMenuImg.addEventListener("mousedown",()=>{webBasicMenuImg.classList.add("scale-down")}),webBasicMenuImg.addEventListener("mouseup",()=>{webBasicMenuImg.classList.remove("scale-down")}),webBasicMenuImg.addEventListener("mouseleave",()=>{webBasicMenuImg.classList.remove("scale-down")}),webBasicMenuImg.addEventListener("touchstart",()=>{webBasicMenuImg.classList.add("scale-down")}),webBasicMenuImg.addEventListener("touchend",()=>{webBasicMenuImg.classList.remove("scale-down")})),ChangeStickerStyleBtnComponent.addEventListener("click",function(){handleChangeStickerStyleBtn(!0);let e=document.querySelectorAll(".sticker-card-container"),t=Array.from(e).filter(function(e){let t=e.getAttribute("data-global");return 0===userData[t].selected});t.forEach(function(e){ApplySelectedStyle(e)})}),document.addEventListener("click",function(e){let t=e.target.closest(".set-logo");if(t){let n=parseInt(t.getAttribute("data-setidnumber")),r=Array.from(document.querySelectorAll(".sticker-card-container[data-global]")).find(function(e){let t=e.getAttribute("data-global");return Math.floor(t/100)===n});r&&r.scrollIntoView({behavior:"smooth"})}}),document.addEventListener("mousedown",function(e){e.target.classList.contains("set-logo")&&e.target.classList.add("scale-down")}),document.addEventListener("mouseup",function(e){e.target.classList.contains("set-logo")&&e.target.classList.remove("scale-down")}),document.addEventListener("mouseleave",function(e){e.target.classList.contains("set-logo")&&e.target.classList.remove("scale-down")}),document.addEventListener("touchstart",function(e){e.target.classList.contains("set-logo")&&e.target.classList.add("scale-down")}),document.addEventListener("touchend",function(e){e.target.classList.contains("set-logo")&&e.target.classList.remove("scale-down")}),LanguageButtons.forEach(e=>{e.addEventListener("click",function(){let e=this.dataset.translationPointer;CurrentLanguageCode=e,TranslationElements.forEach(e=>{let t=e.dataset.translationKey;translateLanguage(CurrentLanguageCode,t)}),LanguageButtons.forEach(e=>e.classList.remove("btnBlue")),this.classList.add("btnBlue"),countVaultStickers(),generateCurrentFiltersModalText(),document.querySelectorAll(".sticker-card-container").forEach(e=>{TranslateStickerName(e,CurrentLanguageCode)}),translateLanguage(CurrentLanguageCode,"set"),translateLanguage(CurrentLanguageCode,"album"),translateLanguage(CurrentLanguageCode,"SpareLabel"),TranslateSetName(CurrentLanguageCode)})}),ManageProfileImg&&(ManageProfileImg.addEventListener("mousedown",()=>{ManageProfileImg.classList.add("scale-down")}),ManageProfileImg.addEventListener("mouseup",()=>{ManageProfileImg.classList.remove("scale-down")}),ManageProfileImg.addEventListener("mouseleave",()=>{ManageProfileImg.classList.remove("scale-down")}),ManageProfileImg.addEventListener("touchstart",()=>{ManageProfileImg.classList.add("scale-down")}),ManageProfileImg.addEventListener("touchend",()=>{ManageProfileImg.classList.remove("scale-down")})),document.addEventListener("click",function(e){let t=e.target.closest(".DownloadProfileBtn");if(t){let r=t.closest(".profile-block"),a=r.getAttribute("data-profile-time"),l=UserProfileList.findIndex(e=>parseInt(e.ProfileLastModifiedTime)===parseInt(a));if(-1!==l){let o=UserProfileList[l],s=UserProfileList[l].ProfileUserData;Object.keys(s).forEach(e=>{s[e].spare=parseInt(s[e].spare),s[e]={...defaultValues,...s[e]}});let c=o.ProfilePlayerIGN,u=o.ProfilePlayerLink,d=o.ProfileLeftoverVaultStars,p=[`CurrentAlbumNumber: ${o.ProfileAlbumNumber}`,`IsPrestige: ${o.ProfileIsPrestige}`,`player-ign: ${c}`,`player-link: ${u}`,`leftover-vault-stars: ${d}`,],g=JSON.stringify(s,null,2),m=p.join("\n")+"\n"+g,f=new Blob([m],{type:"text/plain"}),S=URL.createObjectURL(f),y=document.createElement("a"),b=new Date(o.ProfileLastModifiedTime),C=b.getFullYear(),B=String(b.getMonth()+1).padStart(2,"0"),L=String(b.getDate()).padStart(2,"0"),h=String(b.getHours()).padStart(2,"0"),$=String(b.getMinutes()).padStart(2,"0"),v=String(b.getSeconds()).padStart(2,"0"),T=n.find(e=>e.AlbumNo===o.ProfileAlbumNumber),I=T[`AlbumName${CurrentLanguageCode}`].replace(/\s/g,"");y.download=`mogotools-userData_${I}_${C}${B}${L}_${h}${$}${v}.txt`,y.href=S,y.click()}}}),document.addEventListener("click",function(e){let t=e.target.closest(".DeleteProfileBtn");if(t){let n=t.closest(".profile-block"),r=n.getAttribute("data-profile-time"),a=UserProfileList.findIndex(e=>parseInt(e.ProfileLastModifiedTime)===parseInt(r));console.log(r),-1!==a&&(UserProfileList.splice(a,1),localStorage.setItem("UserProfileList",JSON.stringify(UserProfileList)),OpenManageProfileMenu())}}),document.addEventListener("click",function(t){var n=t.target.closest(".LoadProfileBtn");if(n){let r=n.closest(".profile-block"),a=r.getAttribute("data-profile-time"),l=UserProfileList.findIndex(e=>parseInt(e.ProfileLastModifiedTime)===parseInt(a));if(-1!==l){clearFilters(),ResetAllStickersBtnComponent.click();let o=UserProfileList[l],s=UserProfileList[l].ProfileUserData;CurrentAlbumNumber=o.ProfileAlbumNumber,PlayerIGNInputComponent.value=o.ProfilePlayerIGN,PlayerLinkInputComponent.value=o.ProfilePlayerLink,LeftoverVaultStarsInputComponent.value=o.ProfileLeftoverVaultStars,Object.keys(userData=s).forEach(t=>{let{id:n,...r}=userData[t];parseInt(e.find(e=>e.GlobalID===n).AlbumNo)!==parseInt(CurrentAlbumNumber)?delete userData[t]:userData[t]={id:n,...Object.fromEntries(Object.entries(r).map(([e,t])=>[e,parseInt(t)]))}}),CurrentStickerBoardBlock.innerHTML="",GenerateFilterSetButtons(),SetDefaultFilterStates(),generateCurrentStickerBoard(e,userData,"current-sticker-board"),document.querySelector(`button[data-translation-pointer= ${CurrentLanguageCode}]`).click(),PerformSort({currentTarget:document.querySelector("button[data-sort-type='GlobalID']")}),NotSelectedByDefault(),o.ProfileIsPrestige===IgnorePrestige&&IgnorePrestigeBtnComponent.click(),UpdateTotalStickerQuantity(),UpdateTotalStickerByRarityQuantity(),countSelectedStickers(),countVaultStickers(),endDateTime=UpdateAlbumStartEndTime(),exportUserData(!1);let c=document.querySelectorAll(".change-album-btn");c.forEach(e=>{e.getAttribute("data-album-number")===CurrentAlbumNumber?e.classList.add("btnBlue"):e.classList.remove("btnBlue")}),ManageProfileModal.style.display="none"}}});